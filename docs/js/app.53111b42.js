(function(e){function t(t){for(var r,a,c=t[0],o=t[1],l=t[2],u=0,d=[];u<c.length;u++)a=c[u],Object.prototype.hasOwnProperty.call(s,a)&&s[a]&&d.push(s[a][0]),s[a]=0;for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r]);p&&p(t);while(d.length)d.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,a=1;a<n.length;a++){var c=n[a];0!==s[c]&&(r=!1)}r&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},a={app:0},s={app:0},i=[];function c(e){return o.p+"js/"+({map:"map"}[e]||e)+"."+{map:"15589cf3"}[e]+".js"}function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.e=function(e){var t=[],n={map:1};a[e]?t.push(a[e]):0!==a[e]&&n[e]&&t.push(a[e]=new Promise((function(t,n){for(var r="css/"+({map:"map"}[e]||e)+"."+{map:"af3a89c9"}[e]+".css",s=o.p+r,i=document.getElementsByTagName("link"),c=0;c<i.length;c++){var l=i[c],u=l.getAttribute("data-href")||l.getAttribute("href");if("stylesheet"===l.rel&&(u===r||u===s))return t()}var d=document.getElementsByTagName("style");for(c=0;c<d.length;c++){l=d[c],u=l.getAttribute("data-href");if(u===r||u===s)return t()}var p=document.createElement("link");p.rel="stylesheet",p.type="text/css",p.onload=t,p.onerror=function(t){var r=t&&t.target&&t.target.src||s,i=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");i.code="CSS_CHUNK_LOAD_FAILED",i.request=r,delete a[e],p.parentNode.removeChild(p),n(i)},p.href=s;var f=document.getElementsByTagName("head")[0];f.appendChild(p)})).then((function(){a[e]=0})));var r=s[e];if(0!==r)if(r)t.push(r[2]);else{var i=new Promise((function(t,n){r=s[e]=[t,n]}));t.push(r[2]=i);var l,u=document.createElement("script");u.charset="utf-8",u.timeout=120,o.nc&&u.setAttribute("nonce",o.nc),u.src=c(e);var d=new Error;l=function(t){u.onerror=u.onload=null,clearTimeout(p);var n=s[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;d.message="Loading chunk "+e+" failed.\n("+r+": "+a+")",d.name="ChunkLoadError",d.type=r,d.request=a,n[1](d)}s[e]=void 0}};var p=setTimeout((function(){l({type:"timeout",target:u})}),12e4);u.onerror=u.onload=l,document.head.appendChild(u)}return Promise.all(t)},o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/",o.oe=function(e){throw console.error(e),e};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],u=l.push.bind(l);l.push=t,l=l.slice();for(var d=0;d<l.length;d++)t(l[d]);var p=u;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"04f8":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC"},"0af7":function(e,t,n){},1185:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n("b0c0");var r=n("6a83"),a=n.n(r),s=n("04f8"),i=n.n(s),c=n("e11e");function o(e,t){var n;return e.person&&(n=t[e.person]),n?Object(c["icon"])({iconUrl:n.avatarUrl||"https://avatars.dicebear.com/api/bottts/".concat(encodeURIComponent(n.name),".svg"),iconSize:[32,32],iconAnchor:[16,16],tooltipAnchor:[16,0],popupAnchor:[1,-34],className:"rounded-full shadow-lg border-2 border-gray-500"}):Object(c["icon"])({iconUrl:a.a,shadowUrl:i.a,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]})}},"15d7":function(e,t,n){"use strict";n("0af7")},"365c":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);var r=n("1da1"),a=(n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("96cf"),n("2b0e")),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"flex flex-col",attrs:{id:"app"}},[n("router-view")],1)},i=[],c=n("2877"),o={},l=Object(c["a"])(o,s,i,!1,null,null,null),u=l.exports,d=(n("d3b7"),n("3ca3"),n("ddb0"),n("8c4f")),p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"map fixed w-full h-screen flex flex-col"},[n("Header",{attrs:{small:"",locked:""},scopedSlots:e._u([{key:"actions",fn:function(){return[n("form",{staticClass:"flex gap-2 px-2 items-center",on:{submit:function(t){return t.preventDefault(),e.loadFile.apply(null,arguments)}}},[n("input",{ref:"loadFile",attrs:{type:"file"}}),n("button",{staticClass:"py-1 px-4 rounded-md text-gray-700 bg-gray-200 hover:bg-blue-200 hover:text-blue-900",attrs:{type:"submit"}},[e._v(" Laden ")]),n("a",{staticClass:"block py-1 px-4 rounded-md text-gray-700 bg-gray-200 hover:bg-blue-200 hover:text-blue-900",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.edit.apply(null,arguments)}}},[e._v(" Bearbeiten ➝ ")])])]},proxy:!0}])}),n("Map",{attrs:{locations:e.currentLocations},scopedSlots:e._u([{key:"control",fn:function(){return[n("EventControl",{attrs:{events:e.events,selectedEvent:e.selectedEvent},on:{select:e.selectEvent,next:e.next,previous:e.previous}})]},proxy:!0},{key:"chat",fn:function(){return[e.currentChats?n("ChatWindow",{staticClass:"shadow-lg",attrs:{chats:e.currentChats}}):e._e()]},proxy:!0},{key:"load",fn:function(){},proxy:!0}])})],1)},f=[],h=(n("d81d"),n("c740"),n("96c7")),m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("LMap",{ref:"map",attrs:{zoom:e.zoom,center:e.center}},[n("LTileLayer",{attrs:{url:e.url,attribution:e.attribution}}),n("LControl",{staticClass:"w-full max-w-2xl p-3",staticStyle:{width:"400px"},attrs:{position:"bottomright",disableScrollPropagation:!0}},[e._t("chat")],2),n("LControl",{staticClass:"w-full max-w-xl p-5",staticStyle:{"min-width":"40vw"},attrs:{position:"bottomleft",disableScrollPropagation:!0}},[e._t("control")],2),n("LControl",{staticClass:"w-full max-w-xl",staticStyle:{"min-width":"10vw"},attrs:{position:"topright"}},[e._t("load")],2),e._l(e.mappedLocations,(function(t){return n("LMarker",{key:t.id,attrs:{name:"lolol","lat-lng":t.position,icon:e.icon(t)},on:{click:function(n){return e.alert(t)}}},[n("LTooltip",{attrs:{content:t.description}})],1)})),n("LIcon",{attrs:{"icon-anchor":[16,16]}})],2)},v=[],g=(n("6cc5"),n("e11e")),b=n("2699"),x=n("a40a"),w=n("2253"),y=n("4e2b"),C=n("31dc"),S=n("fbba"),j=n("1185"),O={props:{locations:{type:Array,required:!0}},name:"Example",components:{LMap:b["a"],LTileLayer:x["a"],LControl:w["a"],LMarker:y["a"],LTooltip:C["a"],LIcon:S["a"]},mounted:function(){this.recalculateBounds()},computed:{mappedLocations:function(){var e=this;return this.locations.map((function(t){return e.$store.state.setup.locations[t]}))}},data:function(){return{zoom:13,center:Object(g["latLng"])(52.923,10.405),url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'&copy; <a href="https://mateffy.me">Lukas Mateffy</a> & <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}},methods:{showAlert:function(){alert("Click!")},recalculateBounds:function(){if(0!==this.locations.length){var e=this.mappedLocations.map((function(e){return[e.position.lat,e.position.lng,console.log(e)]}));this.$refs.map.fitBounds(e,{padding:[200,200]})}},icon:function(e){return Object(j["a"])(e,this.$store.state.setup.people)}},watch:{locations:function(){this.recalculateBounds()}}},E=O,k=(n("15d7"),Object(c["a"])(E,m,v,!1,null,null,null)),A=k.exports,L=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"bg-gray-200 rounded-lg px-3 py-3 flex flex-col gap-3 w-full max-w-md shadow-md"},[e.selectedEvent?n("div",{staticClass:"flex flex-col"},[n("h1",{staticClass:"text-lg font-bold"},[e._v(e._s(e.selectedEvent.title))]),n("h2",{staticClass:"text-base font-medium text-gray-500"},[e._v(" "+e._s(new Date(e.selectedEvent.start).toLocaleString())+" "),n("span",{staticClass:"text-gray-400"},[e._v("–")]),e._v(" "+e._s(e.isSameDay(e.selectedEvent.start,e.selectedEvent.end)?new Date(e.selectedEvent.end).toLocaleTimeString():new Date(e.selectedEvent.end).toLocaleString())+" ")])]):e._e(),n("Timeline",{ref:"timeline",attrs:{items:e.timelineEvents,options:e.options,events:["select"],selection:e.selectedEventId},on:{select:e.onEventSelect}}),n("div",{staticClass:"w-full flex"},[n("button",{staticClass:"rounded-l bg-gray-500 text-gray-100 hover:bg-gray-600 active:bg-gray-700 px-2 py-2 flex-1",on:{click:function(t){return e.$emit("previous")}}},[n("i",{staticClass:"el-icon-arrow-left el-icon-left"}),e._v(" Vorheriges Event ")]),n("button",{staticClass:"rounded-r bg-gray-500 text-gray-100 hover:bg-gray-600 active:bg-gray-700 px-2 py-2 flex-1",on:{click:function(t){return e.$emit("next")}}},[e._v(" Nächstes Event "),n("i",{staticClass:"el-icon-arrow-right"})])])],1)},R=[],_=(n("fb6a"),n("13d9")),N={props:{events:{type:Array,required:!0},selectedEvent:{type:Object}},mounted:function(){this.selectedEvent&&this.$refs.timeline.setSelection(this.selectedEvent.id)},components:{Timeline:_["a"]},computed:{selectedEventId:function(){return this.selectedEvent?this.selectedEvent.id:null},timelineEvents:function(){return this.$store.getters["setup/eventList"]},options:function(){return{editable:!1,width:"100%",stack:!1,align:"left",type:"range"}}},methods:{onEventSelect:function(e){var t=e.items;this.$emit("select",t[0]),this.$refs.timeline.focus(t[0])},isSameDay:function(e,t){return new Date(e).toISOString().slice(0,10)===new Date(t).toISOString().slice(0,10)}},watch:{selectedEvent:function(){var e=this;this.selectedEvent&&requestAnimationFrame((function(){e.$refs.timeline.setSelection(e.selectedEvent.id),e.$refs.timeline.focus(e.selectedEvent.id)}))}}},F=N,U=(n("6ec1"),Object(c["a"])(F,L,R,!1,null,null,null)),B=U.exports,M=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"flex flex-col w-full bg-gray-100 bg-opacity-80 rounded-lg overflow-hidden",staticStyle:{"max-height":"70vh"}},[e.selectedChat?[n("button",{class:"w-full bg-"+e.selectedColor+"-300 text-"+e.selectedColor+"-900 py-1 hover:opacity-90",on:{click:function(t){e.chatHidden=!e.chatHidden}}},[e.chatHidden?n("span",[e._v(" Anzeigen "),n("i",{staticClass:"el-icon-arrow-up"})]):n("span",[e._v(" Schließen "),n("i",{staticClass:"el-icon-arrow-down"})])]),n("div",{class:"flex justify-between items-center px-2 py-1 text-xs bg-"+e.selectedColor+"-200 text-"+e.selectedColor+"-800"},[n("div",{staticClass:"flex items-center gap-2"},[n("img",{staticClass:"h-4 w-4 rounded-full",attrs:{src:e.receiver.avatarUrl||"https://avatars.dicebear.com/api/bottts/"+encodeURIComponent(e.receiver.name)+".svg"}}),e._v(" "+e._s(e.receiver.name)+" ")]),n("div",{staticClass:"flex items-center gap-2"},[e._v(" "+e._s(e.sender.name)+" "),n("img",{staticClass:"h-4 w-4 rounded-full",attrs:{src:e.sender.avatarUrl||"https://avatars.dicebear.com/api/bottts/"+encodeURIComponent(e.sender.name)+".svg"}})])]),n("Chat",{staticClass:"w-full transition-all p-2",style:e.chatHidden?{"max-height":"0px",paddingTop:0,paddingBottom:0}:{"max-height":"70vh"},attrs:{sender:e.sender,receiver:e.receiver,messages:e.messages,color:e.selectedColor}})]:e._e(),n("nav",{staticClass:"w-full flex justify-around"},e._l(e.chatList,(function(t){return n("TabButton",{key:t.id,style:"max-width: "+100/e.chatList.length+"%",attrs:{color:e.chatColor(t.type),count:e.filterMessagesForEvent(t.messages,e.selectedEvent).length,active:e.selectedChat.id===t.id},on:{click:function(n){return e.selectChat(t)}}},[n("div",{staticClass:"flex flex-col text-left flex-shrink-1 truncate overflow-ellipsis overflow-hidden"},[n("div",{staticClass:"truncate"},[e._v(e._s(e.toPerson(t.receiver).name))]),n("div",{class:"text-xs text-"+e.selectedColor+"-600"},[e._v(" "+e._s(e.chatName(t.type))+" ")])])])})),1)],2)},I=[];n("7db0"),n("4de4");function T(e,t){return e.filter((function(e){return e.date.toISOString()>=t.start.toISOString()&&e.date.toISOString()<=t.end.toISOString()}))}var z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("button",{class:e.classes,attrs:{disabled:0===e.count},on:{click:function(t){return e.$emit("click",t)}}},[e._t("default"),n("span",{class:e.countClasses},[e._v(e._s(e.count))])],2)},D=[],P=(n("a9e3"),n("99af"),{props:{color:{type:String,default:"gray"},count:{type:Number,default:0},active:{type:Boolean,default:!0}},computed:{classes:function(){return"bg-".concat(this.color,"-300 text-").concat(this.color,"-900 flex-1 py-2 flex gap-2 items-center justify-between px-3 disabled:opacity-50 disabled:cursor-not-allowed font-medium ").concat(this.active?"":"opacity-70 hover:opacity-90")},countClasses:function(){return"bg-".concat(this.color,"-200 text-").concat(this.color,"-800 h-5 px-1 min-w-5 rounded-full inline-block flex items-center justify-center font-mono font-bold")}}}),H=P,q=Object(c["a"])(H,z,D,!1,null,null,null),W=q.exports,Q=n("a8c2"),X={props:{chats:{type:Array,required:!0}},data:function(){return{chatHidden:!1,selectedChat:null}},beforeMount:function(){this.selectedChat=this.chatList[0]},computed:{chatList:function(){var e=this;return this.chats.map((function(t){return e.$store.state.setup.chats[t]}))},selectedEvent:function(){return this.$store.state.setup.events[this.$store.state.map.selectedEventId]},messages:function(){if(!this.selectedChat)return null;var e=T(this.selectedChat.messages,this.selectedEvent);return e},sender:function(){return this.$store.state.setup.people[this.selectedChat.sender]},receiver:function(){return this.$store.state.setup.people[this.selectedChat.receiver]},selectedColor:function(){return this.chatColor(this.selectedChat?this.selectedChat.type:"")}},components:{Chat:Q["a"],TabButton:W},methods:{filterMessagesForEvent:T,toPerson:function(e){return this.$store.state.setup.people[e]||this.$store.state.setup.people[e]},selectChat:function(e){this.selectedChat=e},chatColor:function(e){switch(e){case"whatsapp":return"green";case"sms":return"purple";case"phonelog":return"pink";default:return"gray"}},chatName:function(e){switch(e){case"whatsapp":return"WhatsApp";case"sms":return"SMS";case"phonelog":return"Phone Calls"}}},watch:{chats:function(){var e=this;this.selectedChat&&(this.selectedChat=this.chatList.find((function(t){return t.id===e.selectedChat.id}))||this.chatList[0])}}},$=X,K=Object(c["a"])($,M,I,!1,null,null,null),J=K.exports,G={components:{Header:h["a"],Map:A,EventControl:B,ChatWindow:J},data:function(){return{}},mounted:function(){this.selectEvent(this.events.length>0?this.events[0].id:null)},computed:{selectedEventId:function(){return this.$store.state.map.selectedEventId},eventsObj:function(){return this.$store.state.setup.events},events:function(){return this.$store.getters["setup/eventList"]},selectedEvent:function(){return this.selectedEventId?this.eventsObj[this.selectedEventId]:null},currentChats:function(){return this.selectedEvent?this.selectedEvent.chats:null},currentLocations:function(){return this.selectedEvent?this.selectedEvent.locations:[]}},methods:{loadFile:function(){this.$store.dispatch("setup/loadFile",this.$refs.loadFile.files[0])},edit:function(){this.$router.push("/editor")},selectEvent:function(e){this.$store.commit("map/selectEvent",e)},next:function(){var e=this,t=this.events.findIndex((function(t){return t.id===e.selectedEventId}));-1===t||++t>=this.events.length||this.selectEvent(this.events[t].id)},previous:function(){var e=this,t=this.events.findIndex((function(t){return t.id===e.selectedEventId}));-1===t||--t<0||this.selectEvent(this.events[t].id)}},watch:{eventsObj:function(){this.selectEvent(this.events.length>0?this.events[0].id:null)}}},V=G,Y=Object(c["a"])(V,p,f,!1,null,null,null),Z=Y.exports;a["default"].use(d["a"]);var ee=[{path:"/",name:"Map",component:Z},{path:"/editor",name:"Editor",component:function(){return n.e("map").then(n.bind(null,"49d7"))}}],te=new d["a"]({routes:ee}),ne=te,re=n("2f62"),ae={namespaced:!0,state:function(){return{selectedEventId:null}},mutations:{selectEvent:function(e,t){e.selectedEventId=t}},actions:{}},se=n("5530"),ie=(n("4e82"),n("07ac"),n("2b3d"),n("9861"),n("ac1f"),n("1276"),n("c444")),ce=n("b85c"),oe=(n("e9c4"),n("5319"),n("9b7f")),le=window.zip;function ue(e,t,n,r,a,s){return de.apply(this,arguments)}function de(){return de=Object(r["a"])(regeneratorRuntime.mark((function e(t,n,r,a,s,i){var c,o,l,u,d,p,f,h,m,v,g;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log(n,r,a,s,i),c=new Blob([JSON.stringify({projectName:t,people:n,chats:r,locations:a,events:s},null,2)],{type:"application/json"}),o=new le.BlobWriter("application/zip"),l=new le.ZipWriter(o),e.next=6,l.add("Viz.json",new le.BlobReader(c));case 6:u=0,d=Object.values(r);case 7:if(!(u<d.length)){e.next=42;break}p=d[u],console.log(p),f=Object(ce["a"])(p.messages),e.prev=11,f.s();case 13:if((h=f.n()).done){e.next=31;break}if(m=h.value,console.log(m),!m.mediaSrc){e.next=29;break}return e.prev=17,e.next=20,Object(oe["e"])(m.mediaSrc.replace("Media/","/assets/Media/"),null);case 20:return v=e.sent,g=new Blob([v.buffer],{type:"image/jpeg"}),e.next=24,l.add(m.mediaSrc,new le.BlobReader(g));case 24:e.next=29;break;case 26:e.prev=26,e.t0=e["catch"](17),console.error("could not add file",e.t0);case 29:e.next=13;break;case 31:e.next=36;break;case 33:e.prev=33,e.t1=e["catch"](11),f.e(e.t1);case 36:return e.prev=36,f.f(),e.finish(36);case 39:u++,e.next=7;break;case 42:return e.next=44,l.close();case 44:return e.abrupt("return",o.getData());case 45:case"end":return e.stop()}}),e,null,[[11,33,36,39],[17,26]])}))),de.apply(this,arguments)}console.log(le);var pe={namespaced:!0,state:function(){return{projectName:"Forensik Viz",people:{},chats:{},locations:{},events:{},files:{}}},getters:{eventList:function(e){return Object.values(e.events).sort((function(e,t){var n=e.start,r=t.start;return n<r?-1:n>r?1:0})).map((function(e){return Object(se["a"])(Object(se["a"])({},e),{},{content:e.title})}))}},mutations:{setViz:function(e,t){e.projectName=t.projectName||"Forensik Viz",e.people=t.people||{},e.chats=t.chats||{},e.locations=t.locations||{},e.events=t.events||{},e.files=t.files||{}},setProjectName:function(e,t){e.projectName=t},updateEvent:function(e,t){a["default"].set(e.events,t.id,t)},deleteEvent:function(e,t){a["default"].delete(e.events,t)},addChats:function(e,t){e.chats=Object(se["a"])(Object(se["a"])({},e.chats),t)},addFiles:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.files=Object(se["a"])(Object(se["a"])({},e.files),t)},updateLocation:function(e,t){a["default"].set(e.locations,t.id,t)},deleteLocation:function(e,t){a["default"].delete(e.locations,t.id)},setLocationPerson:function(e,t){var n=t.location,r=t.person;e.locations[n.id].person=r},updatePerson:function(e,t){a["default"].set(e.people,t.id,t.id in e.people?Object(se["a"])(Object(se["a"])({},e.people[t.id]),t):t)},deletePerson:function(e,t){a["default"].delete(e.people,t)}},actions:{exportAsFile:function(e){return Object(r["a"])(regeneratorRuntime.mark((function t(){var n,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ue(e.state.projectName,e.state.people,e.state.chats,e.state.locations,e.state.events,e.state.files);case 2:n=t.sent,r=window.URL.createObjectURL(n),a=document.createElement("a"),a.href=r,a.download="".concat((new Date).toISOString().split(".")[0],".viz"),a.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),setTimeout((function(){window.URL.revokeObjectURL(r),a.remove()}),100);case 9:case"end":return t.stop()}}),t)})))()},loadFile:function(e,t){return Object(r["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.t0=e,n.next=3,Object(ie["b"])(t);case 3:n.t1=n.sent,n.t0.commit.call(n.t0,"setViz",n.t1);case 5:case"end":return n.stop()}}),n)})))()}}};a["default"].use(re["a"]);var fe=new re["a"].Store({state:{people:{1:{name:"Markus Gasleiter",avatarUrl:"https://i.pravatar.cc/300"},2:{name:"Frank Susmann",avatarUrl:"https://i.pravatar.cc/200"}}},mutations:{},actions:{},modules:{map:ae,setup:pe}}),he=(n("0fae"),n("ba8c"),n("0808"),n("6944")),me=n.n(he);function ve(){return ge.apply(this,arguments)}function ge(){return ge=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(oe["c"])();case 2:a["default"].use(me.a),a["default"].config.productionTip=!1,new a["default"]({router:ne,store:fe,render:function(e){return e(u)}}).$mount("#app");case 5:case"end":return e.stop()}}),e)}))),ge.apply(this,arguments)}ve().catch((function(e){return console.error("GLOBAL CATCH:",e)}))},"6a83":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII="},"6ec1":function(e,t,n){"use strict";n("365c")},"96c7":function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("header",{class:{"bg-blue-600 text-blue-100 font-bold flex items-center justify-between":!0,"h-12 px-3":!e.small,"h-8 text-xs":e.small}},[n("h1",{staticClass:"flex-1"},[n("input",{staticClass:"font-bold text-blue-100 bg-transparent border-none focus:bg-blue-100 focus:text-blue-900 rounded pl-2",class:{"text-sm":e.small,"text-xl":!e.small},attrs:{type:"text",name:"",disabled:e.locked},domProps:{value:e.projectName},on:{input:e.changedProjectName}})]),n("nav",{staticClass:"mx-auto flex justify-center items-center my-5 px-10"},[e._t("nav")],2),n("div",{staticClass:"flex-1 flex justify-end items-center gap-5"},[e._t("actions")],2)])},a=[],s={props:{small:{type:Boolean},locked:{type:Boolean,default:function(){return!1}}},computed:{projectName:function(){return this.$store.state.setup.projectName}},methods:{changedProjectName:function(e){this.$store.commit("setup/setProjectName",e.target.value)}}},i=s,c=n("2877"),o=Object(c["a"])(i,r,a,!1,null,null,null);t["a"]=o.exports},"9b7f":function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return p})),n.d(t,"f",(function(){return h})),n.d(t,"a",(function(){return v}));var r=n("b85c"),a=n("1da1"),s=(n("d3b7"),n("ac1f"),n("1276"),n("fb6a"),n("96cf"),n("3b92")),i=new e.FileSystem.MountableFileSystem,c=e.BFSRequire("buffer").Buffer;function o(){return l.apply(this,arguments)}function l(){return l=Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.initialize(i),console.log(s["FileFlag"]),i.mount("/assets",new e.FileSystem.InMemory),t.next=5,b("/assets/Media");case 5:return t.next=7,h("/assets/Media/test.txt","Hello World!");case 7:window.fs=i,window.BrowserFS=e;case 9:case"end":return t.stop()}}),t)}))),l.apply(this,arguments)}function u(e){return d.apply(this,arguments)}function d(){return d=Object(a["a"])(regeneratorRuntime.mark((function t(n){var r,a=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=a.length>1&&void 0!==a[1]?a[1]:"/import",t.abrupt("return",new Promise((function(t,a){i.existsSync(r)&&i.umount(r);var s=new FileReader;s.onload=function(n){var a=n.target.result;i.mount(r,new e.FileSystem.ZipFS(c.from(a))),t()},s.onerror=a,s.readAsArrayBuffer(n)})));case 2:case"end":return t.stop()}}),t)}))),d.apply(this,arguments)}function p(e){return f.apply(this,arguments)}function f(){return f=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n,r,a=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:"utf8",r=a.length>2&&void 0!==a[2]?a[2]:new s["FileFlag"]("r"),e.abrupt("return",new Promise((function(e,a){i.readFile(t,n,r,(function(t,n){t?a(t):e(n)}))})));case 3:case"end":return e.stop()}}),e)}))),f.apply(this,arguments)}function h(e,t){return m.apply(this,arguments)}function m(){return m=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){i.writeFile(t,n,"utf8",new s["FileFlag"]("w+"),0,(function(t){t?r(t):e()}))})));case 1:case"end":return e.stop()}}),e)}))),m.apply(this,arguments)}function v(e){return g.apply(this,arguments)}function g(){return g=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n,a,s,c,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=t.split("/"),n=n.slice(1,n.length-1),console.log("Paths",n),a="",s=Object(r["a"])(n);try{for(s.s();!(c=s.n()).done;)o=c.value,a+="/"+o,console.log("Ensure Path",a,n),i.existsSync(a)||i.mkdirSync(a)}catch(l){s.e(l)}finally{s.f()}case 6:case"end":return e.stop()}}),e)}))),g.apply(this,arguments)}function b(e){return x.apply(this,arguments)}function x(){return x=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){i.mkdir(t,0,(function(t){t?n(t):e()}))})));case 1:case"end":return e.stop()}}),e)}))),x.apply(this,arguments)}}).call(this,n("187c"))},a8c2:function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"flex flex-col gap-3 overflow-y-scroll pb-5"},[n("div",{staticClass:"text-center text-xs font-medium text-gray-900 opacity-40"},[e._v(" "+e._s(e.safeFirstDate.toLocaleString())+" ")]),e._l(e.rebasedMessages,(function(t){return n("Bubble",{key:t.id,attrs:{message:t,right:t.isSender,sender:t.isSender?e.sender:e.receiver,color:e.color+"-200"}})}))],2)},a=[],s=n("5530"),i=(n("d81d"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:"w-full flex "+(e.right?"justify-end pl-12":"justify-start pr-12")},[n("div",{class:"max-w-sm flex gap-2  "+(this.right?"flex-row-reverse":"")},[n("img",{staticClass:"h-6 w-6 rounded-full",attrs:{src:e.sender.avatarUrl||"https://avatars.dicebear.com/api/bottts/"+encodeURIComponent(e.sender.name)+".svg"}}),n("div",{class:e.classes},[e.message.mediaSrc?n("button",{staticClass:"block mb-2 w-full"},[n("FSImg",{attrs:{src:e.message.mediaSrc,mime:e.message.mimeType},on:{click:e.onImageClick}})],1):e._e(),e.message.text?n("p",{class:"block text-gray-900 mb-2"},[e._v(" "+e._s(e.message.text)+" ")]):e._e(),n("span",{class:"block text-xs text-gray-900 opacity-60 "+(e.right?"text-right":"")},[e._v(" "+e._s(e.message.date.toLocaleString())+" ")])])])])}),c=[],o=n("ade3"),l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.isImage?n("img",{staticClass:"w-full",attrs:{src:e.url},on:{click:function(t){return e.$emit("click",t)}}}):n("video",{staticClass:"w-full",attrs:{controls:"",loop:""}},[n("source",{attrs:{src:e.url,type:e.mime}})])])},u=[],d={props:{src:{type:String,required:!0},mime:{type:String,default:"image/jpeg"}},data:function(){return{dataUri:""}},created:function(){},computed:{url:function(){return this.$store.state.setup.files[this.src]},isImage:function(){return-1===(this.mime||"image/jpeg").indexOf("video")}}},p=d,f=n("2877"),h=Object(f["a"])(p,l,u,!1,null,null,null),m=h.exports,v={props:{message:{type:Object,required:!0},sender:{type:Object,default:function(){return{id:"1ed7504b-35bd-41b7-b8d7-38149b8a027c",name:"Unbekannt",avatarUrl:"https://cdn.cloudflare.steamstatic.com/steamcommunity/public/images/avatars/00/00bb8a893a2e125c3fce471364154f950a8db60d.jpg",color:"purple"}}},right:{type:Boolean,default:!1},color:{type:String,default:"gray-300"}},computed:{classes:function(){var e;return e={"block px-3 py-2 rounded-lg text-left shadow":!0},Object(o["a"])(e,"rounded-tr-none bg-".concat(this.color),!!this.right),Object(o["a"])(e,"rounded-tl-none bg-gray-300",!this.right),e}},methods:{onImageClick:function(e){this.$viewerApi({images:[e.target.src],options:{toolbar:!1,navbar:!1}})}},components:{FSImg:m}},g=v,b=Object(f["a"])(g,i,c,!1,null,null,null),x=b.exports,w={props:{messages:{type:Array,required:!0},sender:{type:Object,required:!0},receiver:{type:Object,required:!0},color:{type:String,default:"green"},firstDate:{type:Date},basePath:{type:String,default:"/import/Export/files/media/0/WhatsApp/Media/"}},computed:{safeFirstDate:function(){return this.messages[0]?this.messages[0].date:this.firstDate||new Date},rebasedMessages:function(){return this.messages.map((function(e){return e.mediaSrc?Object(s["a"])({},e):e}))}},components:{Bubble:x},methods:{}},y=w,C=Object(f["a"])(y,r,a,!1,null,null,null);t["a"]=C.exports},ba8c:function(e,t,n){},c444:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return h})),n.d(t,"b",(function(){return v}));var r=n("b85c"),a=n("5530"),s=n("1da1"),i=(n("ac1f"),n("5319"),n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),n("9861"),n("820e"),n("07ac"),n("96cf"),n("c64e")),c=n.n(i),o=n("9b7f"),l=null;function u(){return d.apply(this,arguments)}function d(){return d=Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(l){e.next=4;break}return e.next=3,window.initSqlJs({locateFile:function(e){return"https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.6.1/".concat(e)}});case 3:l=e.sent;case 4:return e.abrupt("return",l);case 5:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}function p(e,t){return f.apply(this,arguments)}function f(){return f=Object(s["a"])(regeneratorRuntime.mark((function e(t,n){var r,s,i,c,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=n.chats,s=n.people,i=n.files,e.next=3,u();case 3:return c=e.sent,o=new c.Database(t),o.each("SELECT DISTINCT Contact, ContactAlias FROM data",{},(function(e){var t={id:e.Contact,name:e.ContactAlias};s[t.id]=Object(a["a"])(Object(a["a"])({id:e.Contact},s[t.id]||{}),{},{name:e.ContactAlias||e.Contact})})),e.abrupt("return",{chats:r,people:s,files:i});case 7:case"end":return e.stop()}}),e)}))),f.apply(this,arguments)}function h(e){return m.apply(this,arguments)}function m(){return m=Object(s["a"])(regeneratorRuntime.mark((function e(t){var n,r,a,i,l,d,p,f,h,m,v;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u();case 2:for(n=e.sent,r=new n.Database(t),a={},i=[],l={},d={},p=[],r.each("SELECT\n\t\t\tmessages.*,\n\t\t\tmessage_media.file_path\n\t\tFROM\n\t\t\tmessages\n\t\t\tLEFT JOIN message_media ON messages.media_url = message_media.message_url",{},(function(e){var t={id:e.key_remote_jid,name:e.key_remote_jid,avatarUrl:"https://cdn.cloudflare.steamstatic.com/steamcommunity/public/images/avatars/00/00bb8a893a2e125c3fce471364154f950a8db60d.jpg",color:"green"};a[t.id]?t=a[t.id]:a[t.id]=t;var n={id:c()(),sender:t.id,chatId:t.id,date:new Date(e.timestamp),type:"text",isSender:1===e.key_from_me,text:e.data||e.media_caption,mediaSrc:e.file_path,mimeType:e.media_mime_type};n.mediaSrc&&p.push(Object(s["a"])(regeneratorRuntime.mark((function e(){var t,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(o["e"])(n.mediaSrc.replace("Media/","/import/Export/files/media/0/WhatsApp/Media/"),null);case 3:return t=e.sent,r=new Blob([t.buffer],{type:n.mimeType||"image/jpeg"}),d[n.mediaSrc]=URL.createObjectURL(r),a=n.mediaSrc.replace("Media/","/assets/Media/"),console.log(a),e.next=10,Object(o["a"])(a);case 10:return e.next=12,Object(o["f"])(a,t,null);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](0),console.error("could not fetch file",n.mediaSrc,e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})))()),(n.text||n.mediaSrc)&&i.push(n)})),f=0,h=i;f<h.length;f++)m=h[f],v="chat-".concat(m.chatId),v in l?l[v].messages.push(m):l[v]={id:v,type:"whatsapp",receiver:m.chatId,sender:null,messages:[m]};return e.next=13,Promise.allSettled(p);case 13:return e.abrupt("return",{chats:l,people:a,files:d});case 14:case"end":return e.stop()}}),e)}))),m.apply(this,arguments)}function v(e){return g.apply(this,arguments)}function g(){return g=Object(s["a"])(regeneratorRuntime.mark((function e(t){var n,a,s,i,c,l,u,d,p,f,h,m;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["d"])(t,"/load");case 2:return e.t0=JSON,e.next=5,Object(o["e"])("/load/Viz.json");case 5:e.t1=e.sent,n=e.t0.parse.call(e.t0,e.t1),console.log(n),n.files={},a=0,s=Object.values(n.chats);case 10:if(!(a<s.length)){e.next=48;break}i=s[a],c=Object(r["a"])(i.messages),e.prev=13,c.s();case 15:if((l=c.n()).done){e.next=37;break}if(u=l.value,e.prev=17,u.date=new Date(u.date),console.info(u.mediaSrc),!u.mediaSrc){e.next=30;break}return e.next=23,Object(o["e"])("/load/".concat(u.mediaSrc),null);case 23:return d=e.sent,p=new Blob([d.buffer],{type:u.mimeType||"image/jpeg"}),n.files[u.mediaSrc]=URL.createObjectURL(p),e.next=28,Object(o["a"])("/assets/".concat(u.mediaSrc));case 28:return e.next=30,Object(o["f"])("/assets/".concat(u.mediaSrc),d,null);case 30:e.next=35;break;case 32:e.prev=32,e.t2=e["catch"](17),console.error("could not fetch file",u.mediaSrc,e.t2);case 35:e.next=15;break;case 37:e.next=42;break;case 39:e.prev=39,e.t3=e["catch"](13),c.e(e.t3);case 42:return e.prev=42,c.f(),e.finish(42);case 45:a++,e.next=10;break;case 48:for(f=0,h=Object.values(n.events);f<h.length;f++)m=h[f],m.start=new Date(m.start),m.end=new Date(m.end);return e.abrupt("return",n);case 50:case"end":return e.stop()}}),e,null,[[13,39,42,45],[17,32]])}))),g.apply(this,arguments)}}});
//# sourceMappingURL=app.53111b42.js.map